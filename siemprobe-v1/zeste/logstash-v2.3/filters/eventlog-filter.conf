4690 : Une tentative de duplication d’un handle vers un objet a été effectuée
4663 : Une tentative d’accès à un objet a été effectuée
4660 : Un objet a été supprimé
4658 : Le handle vers un objet a été fermé
4659 : Un handle vers un objet a été demandé dans un but de suppression -> 4660 si OK = AUDIT_SUCCESS
4663 : Un handle vers un objet a été demandé -> 4663 si OK = AUDIT_SUCCESS
4634 : Fermeture de session d’un compte
4624 : L’ouverture de session d’un compte s’est correctement déroulée.
4625 : Échec d’ouverture de session d’un compte.

work @ http://grokdebug.herokuapp.com

if [message] =~ /(?i)lost|degraded|ntpd|pageretire|apd|permanentloss|atquota|pathstatechanges|visorfs|heartbeat|corrupt|disconnect|scsipath\.por|dump|duplicate/ {

https://github.com/sexibytes/sexilog/blob/master/logstash/conf.d/filter-syslog-esxi.conf
faire avec ?? : 
match => [
						"message", "(?<msg>msg\.[a-zA-Z0-9\-_\.]+)"
					]		



filter {
    if [type] == "eventlog" {
    	if [message] =~ /(?i)AUDIT_SUCCESS|AUDIT_FAILURE/ and [message] != /(?i)4624/{
			grok {
			    match => [
			    	"message", "%{TIMESTAMP_ISO8601:evt_timestamp} %{SYSLOGHOST:host} %{DATA:status} %{DATA:id} %{DATA:description}[.](?i)Nom.du.compte.:..%{DATA:useraccount}[\s](?i)Domaine.du.compte.:..%{DATA:domainaccount}[\s]",
				    "message", "(?i)Nom.du.compte.:..%{DATA:useraccount}[\s]",
			    	"message", "(?i)Domaine.du.compte.:..%{DATA:domainaccount}[\s]",
			    	"message", "(?i)Nom.de...objet.:..%{DATA:objectname}[\s]",
			    	"message", "(?i)Nom.du.processus.:..%{DATA:objectname}[\s]"
			        
			    	]
			}
			mutate {
	    		remove_field => [ "message", "@version" ]
			}	
		}	
    }
}


filter {
    if [type] == "eventlog" {
			grok {
			    match => [
			    	"message", "%{TIMESTAMP_ISO8601:evt_timestamp} %{SYSLOGHOST:host} %{DATA:status} %{DATA:id} %{DATA:description}[.]"
			    	]
			}
			mutate {
	    		remove_field => [ "message", "@version" ]
			}		
    }
}




filter {
    if [type] == "eventlog" {
    	if [message] =~ /(?i)AUDIT_SUCCESS|AUDIT_FAILURE/ and [message] !~ /(?i)4624/{
			grok {
			    match => [
			    	"message", "%{TIMESTAMP_ISO8601:evt_timestamp} %{SYSLOGHOST:host} %{DATA:status} %{DATA:id} %{DATA:description}[.]",
				    "message", "(?i)Nom.du.compte.:..%{DATA:useraccount}[\s]",
			    	"message", "(?i)Domaine.du.compte.:..%{DATA:domainaccount}[\s]",
			    	"message", "(?i)Nom.de...objet.:..%{DATA:objectname}[\s]",
			    	"message", "(?i)Nom.du.processus.:..%{DATA:objectname}[\s]"
			        
			    	]
			}
			mutate {
	    		remove_field => [ "message", "@version" ]
			}	
		}	
    }
}



filter {
    if [type] == "eventlog" {
    	if [message] =~ /(?i)AUDIT_SUCCESS|AUDIT_FAILURE/{
			grok {
			    match => [
				    "message", "(?i)Nom.du.compte.:..%{DATA:useraccount}[\s]",
			    	"message", "(?i)Domaine.du.compte.:..%{DATA:domainaccount}[\s]",
			    	"message", "(?i)Nom.de...objet.:..%{DATA:objectname}[\s]",
			    	"message", "(?i)Nom.du.processus.:..%{DATA:objectname}[\s]",
				    "message", "%{TIMESTAMP_ISO8601:evt_timestamp} %{SYSLOGHOST:host} %{DATA:status} %{DATA:id} %{DATA:description}[.]"
			        
			    	]
			}
			mutate {
	    		remove_field => [ "message", "@version" ]
			}	
		}	
    }
}




filter {
    if [type] == "eventlog" {
    	if [message] =~ /(?i)AUDIT_SUCCESS|AUDIT_FAILURE/{
			grok {
			    match => [
				    "message", "(?i)Nom.du.compte.:..%{DATA:useraccount}[\s]",
			    	"message", "(?i)Domaine.du.compte.:..%{DATA:domainaccount}[\s]",
			    	"message", "(?i)Nom.de...objet.:..%{DATA:objectname}[\s]",
			    	"message", "(?i)Nom.du.processus.:..%{DATA:objectname}[\s]",
				    "message", "%{TIMESTAMP_ISO8601:evt_timestamp} %{SYSLOGHOST:host} %{DATA:status} %{DATA:id} %{DATA:description}[.]"
			        
			    	]
			}
			mutate {
	    		remove_field => [ "message", "@version" ]
			}	
		}	
    }
}







filter {
    if [type] == "eventlog" {
		grok {
		    match => [
			    "message", "(?i)Nom.du.compte.:..%{DATA:useraccount}[\s]",
		    	"message", "(?i)Domaine.du.compte.:..%{DATA:domainaccount}[\s]",
		    	"message", "(?i)Nom.de...objet.:.%{DATA:objectname}[\s]",
		    	"message", "(?i)Nom.du.processus.:..%{DATA:objectname}[\s]",
			    "message", "%{TIMESTAMP_ISO8601:evt_timestamp} %{SYSLOGHOST:host} %{DATA:status} %{DATA:id} %{DATA:description}[.]"
		        
		    	]
		}
		mutate {
    		remove_field => [ "message", "@version" ]
		}	
    }
}


filter {
    if [type] == "eventlog" {
		grok {
		    match => [
			    "message", "(?i)Nom.du.compte.:..%{DATA:useraccount}[\s]",
		    	"message", "(?i)Domaine.du.compte.:..%{DATA:domainaccount}[\s]",
		    	"message", "(?i)Nom.de...objet.:.%{DATA:objectname}[\s]",
		    	"message", "(?i)Nom.du.processus.:..%{DATA:objectname}[\s]",
			    "message", "%{TIMESTAMP_ISO8601:evt_timestamp} %{SYSLOGHOST:host} %{DATA:status} %{DATA:id} %{DATA:description}[.]"
		        
		    	]
		}
		mutate {
    		remove_field => [ "message", "@version" ]
		}	
    }
}


mutate {
    remove_field => [ "message", "@version" ]
}



filter {
    if [type] == "eventlog" {
		grok {
			match => { "message" => "%{TIMESTAMP_ISO8601:evt_timestamp} %{SYSLOGHOST:host} %{DATA:status} %{DATA:id} %{DATA:description}[.]" }
			if [id] == "4634" or "4658" or "4659" or "4660" or "4663" {
				grok {
					match => [
				    	"message", "(?i)Nom.du.compte.:..%{DATA:useraccount}[\s]",
				    	"message", "(?i)Domaine.du.compte.:..%{DATA:domainaccount}[\s]",
				    	"message", "(?i)Nom.de...objet.:.%{DATA:objectname}[\s]",
				    	"message", "(?i)Nom.du.processus.:..%{DATA:objectname}[\s]"
			    	]
				}
			}
		}
		remove_field => [ "message", "@version" ]	
	}
}

(?i)Nom.de...objet.:.%{DATA:objectname}[\s] 

(?i)Nom.du.processus.:..%{DATA:objectname}[\s]

(held for 272 msecs).  
[\s]%{NUMBER:milliseconds:int}[\s].*(ms|msecs)  -> 272 

Nom du compte :  Mathilde  Domaine du compte :  KLIMA
[\s]%{DATA:eventlog_useraccount}[\s].*(Domaine)

filter {
	if [type] == "eventlog" {
		grok {
			match => [
					"message", "[\s](?i)Nom du compte :%{DATA:eventlog_useraccount}[\s](Domaine)",
					"message", "[\s](?i)Domaine du compte :%{DATA:eventlog_useraccount}[\s](ID)",
    				"message", "[\s](?i)Nom de l’objet :%{DATA:eventlog_objectname}[\s](ID)",
    				"message", "%{TIMESTAMP_ISO8601:eventlog_timestamp} %{SYSLOGHOST:eventlog_host} %{DATA:eventlog_status} %{DATA:eventlog_id} %{DATA:eventlog_description}[.]"
			]
		} 
	}        
}



filter {
	if [type] == "eventlog" {
		grok {
			match => [
					"message" => "%{TIMESTAMP_ISO8601:eventlog_timestamp} %{SYSLOGHOST:eventlog_host} %{DATA:eventlog_status} %{DATA:eventlog_id} %{DATA:eventlog_description}[.]",
					"message" => "[\s](?i)Nom du compte :%{DATA:eventlog_useraccount}[\s](Domaine)",
					"message" => "[\s](?i)Domaine du compte :%{DATA:eventlog_useraccount}[\s](ID)",
    				"message" => "[\s](?i)Nom de l’objet :%{DATA:eventlog_objectname}[\s](ID)"
			]
		} 
	}        
}


4659 / 4660 : Un objet a été supprimé
4656 / 4663 : Un handle vers un objet a été demandé + OK 
4624 
4625
------------------------------------------------------------------------  

4659
2016-07-01 17:50:09 SRVKLIMAD.KLIMA.local AUDIT_SUCCESS 4659 Un handle vers un objet a été demandé dans un but de suppression.  Sujet :  ID de sécurité :  S-1-5-21-234956876-1872495229-1672620402-3124  Nom du compte :  Mathilde  Domaine du compte :  KLIMA  ID d’ouverture de session :  0x500CD6D10  Objet :  Serveur de l’objet : Security  Type d’objet : File  Nom de l’objet : D:\dfs\appdata\mathilde\Application Data\Microsoft\Windows\Themes\CachedFiles\CachedImage_1920_1080_POS0.jpg  ID du handle : 0x0  Informations sur le processus :  ID du processus : 0x4  Informations sur la demande d’accès :  ID de la transaction : {00000000-0000-0000-0000-000000000000}  Accès : DELETE     ReadAttributes       Masque d’accès : 0x10080  Privilèges utilisés pour les vérifications d’accès : -
%{TIMESTAMP_ISO8601:eventlog_timestamp} %{SYSLOGHOST:eventlog_host} %{DATA:eventlog_status} %{DATA:eventlog_id} %{DATA:eventlog_description}[.] %{DATA:dummy_payload}[:] %{DATA:dummy_payload}[:] %{DATA:eventlog_secid}[\s] %{DATA:dummy_payload}[:] %{DATA:eventlog_useraccount}[\s] %{DATA:dummy_payload}[:] %{DATA:eventlog_domainaccount}[\s] %{DATA:dummy_payload}[:] %{DATA:dummy_payload}[:] %{DATA:dummy_payload}[:] %{DATA:eventlog_key}[\s] %{DATA:dummy_payload}[:] %{DATA:eventlog_objecttype}[\s] %{DATA:dummy_payload}[:] %{DATA:eventlog_objectname}[\s] %{DATA:dummy_payload}[:] 


message -> [\s](?i)Nom du compte :%{DATA:eventlog_useraccount}[\s](Domaine)
message -> [\s](?i)Domaine du compte :%{DATA:eventlog_useraccount}[\s](ID)
message -> [\s](?i)Nom de l’objet :%{DATA:eventlog_objectname}[\s](ID)



4660 

4656

4663
2016-07-01 18:09:13 SRVKLIMAD.KLIMA.local AUDIT_SUCCESS 4663 Une tentative d’accès à un objet a été effectuée.  Sujet :  ID de sécurité :  S-1-5-21-234956876-1872495229-1672620402-1112  Nom du compte :  monique  Domaine du compte :  KLIMA  ID d’ouverture de session :  0x500BAA0E7  Objet :  Serveur de l’objet :  Security  Type d’objet :  File  Nom de l’objet :  D:\dfs\appdata\Monique\Application Data\Mozilla\Firefox\Profiles\0ox5cdcf.default\datareporting  ID du handle :  0x6b18  Attributs de ressource : S:AI  Informations sur le processus :  ID du processus :  0x4  Nom du processus :    Informations sur la demande d’accès :  Accès :  Écriture données (ou ajout fichier)       Masque d’accès :  0x2

4624
2016-07-01 18:14:20 SRVKLIMAD.KLIMA.local AUDIT_SUCCESS 4624 L’ouverture de session d’un compte s’est correctement déroulée.  Sujet :  ID de sécurité :  S-1-0-0  Nom du compte :  -  Domaine du compte :  -  ID d’ouverture de session :  0x0  Type d’ouverture de session :   3  Niveau d’emprunt d’identité :  Délégation  Nouvelle ouverture de session :  ID de sécurité :  S-1-5-21-234956876-1872495229-1672620402-3605  Nom du compte :  SRVKLIMSQL$  Domaine du compte :  KLIMA  ID d’ouverture de session :  0x51BDCB392  GUID d’ouverture de session :  {CF630B48-68AF-AF94-5A31-C2E2D8C6260F}  Informations sur le processus :  ID du processus :  0x0  Nom du processus :  -  Informations sur le réseau :  Nom de la station de travail :   Adresse du réseau source : 192.168.1.9  Port source :  63201  Informations détaillées sur l’authentification :  Processus d’ouverture de session :  Kerberos  Package d’authentification : Kerberos  Services en transit : -  Nom du package (NTLM uniquement) : -  Longueur de la clé :  0  Cet événement est généré lors de la création d’une ouverture de session. Il est généré sur l’ordinateur sur lequel l’ouverture de session a été effectuée.  Le champ Objet indique le compte sur le système local qui a demandé l’ouverture de session. Il s’agit le plus souvent d’un service, comme le service Serveur, ou un processus local tel que Winlogon.exe ou Services.exe.  Le champ Type d’ouverture de session indique le type d’ouverture de session qui s’est produit. Les types les plus courants sont 2 (interactif) et 3 (réseau).  Le champ Nouvelle ouverture de session indique le compte pour lequel la nouvelle ouverture de session a été créée, par exemple, le compte qui s’est connecté.  Les champs relatifs au réseau indiquent la provenance d’une demande d’ouverture de session à distance. Le nom de la station de travail n’étant pas toujours disponible, peut être laissé vide dans certains cas.  Le champ du niveau d’emprunt d’identité indique la portée de l’emprunt d’identité que peut prendre un processus dans la session d’ouverture de session.  Les champs relatifs aux informations d’authentification fournissent des détails sur cette demande d’ouverture de session spécifique.  - Le GUID d’ouverture de session est un identificateur unique pouvant servir à associer cet événement à un événement KDC .  - Les services en transit indiquent les services intermédiaires qui ont participé à cette demande d’ouverture de session.  - Nom du package indique quel est le sous-protocole qui a été utilisé parmi les protocoles NTLM.  - La longueur de la clé indique la longueur de la clé de session générée. Elle a la valeur 0 si aucune clé de session n’a été demandée.

4625
2016-07-01 16:22:42 SRVKLIMAD.KLIMA.local AUDIT_FAILURE 4625 Échec d’ouverture de session d’un compte.  Sujet :  ID de sécurité :  S-1-0-0  Nom du compte :  -  Domaine du compte :  -  ID d’ouverture de session :  0x0  Type d’ouverture de session :   3  Compte pour lequel l’ouverture de session a échoué :  ID de sécurité :  S-1-0-0  Nom du compte :  administrateur  Domaine du compte :  klima  Informations sur l’échec :  Raison de l’échec :  Une erreur s’est produite lors de l’ouverture de session.  État :   0xC0000225  Sous-état :  0x0  Informations sur le processus :  ID du processus de l’appelant : 0x0  Nom du processus de l’appelant : -  Informations sur le réseau :  Nom de la station de travail : \\192.168.1.15  Adresse du réseau source : 192.168.1.15  Port source :  57798  Informations détaillées sur l’authentification :  Processus d’ouverture de session :    Package d’authentification : NTLM  Services en transit : -  Nom du package (NTLM uniquement) : -  Longueur de clé :  0  Cet événement est généré lorsqu’une demande d’ouverture de session échoue. Il est généré sur l’ordinateur sur lequel l’accès a été tenté.  Le champ Objet indique le compte sur le système local qui a demandé l’ouverture de session. Il s’agit le plus souvent d’un service, comme le service Serveur, ou un processus local tel que Winlogon.exe ou Services.exe.  Le champ Type d’ouverture de session indique le type d’ouverture de session qui a été demandé. Les types les plus courants sont 2 (interactif) et 3 (réseau).  Les champs relatifs aux informations sur le processus indiquent quel est le compte et le processus sur le système qui ont demandé l’ouverture de session.  Les champs relatifs aux informations sur le réseau indiquent la provenance de la demande d’ouverture de session distante. Le nom de la station de travail n’étant pas toujours disponible, peut rester vide dans certains cas.  Les champs relatifs aux informations d’authentification fournissent des détails sur cette demande d’ouverture de session spécifique.  - Les services en transit indiquent les services intermédiaires qui ont participé à cette demande d’ouverture de session.  - Le nom du package indique quel a été le sous-protocole qui a été utilisé parmi les protocoles NTLM.  - La longueur de la clé indique la longueur de la clé de session générée. Elle a la valeur 0 si aucune clé de session n’a été demandée.



------------------------------------------------------------------------

OK : 4659 4663, 
%{TIMESTAMP_ISO8601:eventlog_timestamp} %{SYSLOGHOST:eventlog_host} %{DATA:eventlog_status} %{DATA:eventlog_id} %{DATA:eventlog_description}[.] %{DATA:dummy_payload}[:] %{DATA:dummy_payload}[:] %{DATA:eventlog_secid}[\s] %{DATA:dummy_payload}[:] %{DATA:eventlog_useraccount}[\s] %{DATA:dummy_payload}[:] %{DATA:eventlog_domainaccount}[\s] %{DATA:dummy_payload}[:] %{DATA:dummy_payload}[:] %{DATA:dummy_payload}[:] %{DATA:eventlog_key}[\s] %{DATA:dummy_payload}[:] %{DATA:eventlog_objecttype}[\s] %{DATA:dummy_payload}[:] %{DATA:eventlog_objectname}[\s] %{DATA:dummy_payload}[:] 


2016-06-30 18:28:02 SRVKLIMAD.KLIMA.local AUDIT_SUCCESS 4659 Un handle vers un objet a été demandé dans un but de suppression.  Sujet :  ID de sécurité :  S-1-5-21-234956876-1872495229-1672620402-4140  Nom du compte :  Magasin2  Domaine du compte :  KLIMA  ID d’ouverture de session :  0x4D10413B4  Objet :  Serveur de l’objet : Security  Type d’objet : File  Nom de l’objet : D:\dfs\appdata\magasin2\Application Data\Microsoft\Windows\Themes\CachedFiles\CachedImage_1440_900_POS4.jpg  ID du handle : 0x0


%{TIMESTAMP_ISO8601:eventlog_timestamp} %{SYSLOGHOST:eventlog_host} %{DATA:eventlog_status} %{DATA:eventlog_id} %{DATA:eventlog_description}[.] %{DATA:dummy_payload}[:] %{DATA:dummy_payload}[:] %{DATA:eventlog_secid}[\s] %{DATA:dummy_payload}[:] %{DATA:eventlog_useraccount}[\s] %{DATA:dummy_payload}[:] %{DATA:eventlog_domainaccount}[\s] %{DATA:dummy_payload}[:] %{DATA:dummy_payload}[:] %{DATA:dummy_payload}[:] %{DATA:eventlog_key}[\s] 




In

2016-06-30 18:28:02 SRVKLIMAD.KLIMA.local AUDIT_SUCCESS 4659 Un handle vers un objet a été demandé dans un but de suppression.  Sujet :  ID de sécurité :  S-1-5-21-234956876-1872495229-1672620402-4140  Nom du compte :  Magasin2  Domaine du compte :  KLIMA  ID d’ouverture de session :  0x4D10413B4  Objet :  Serveur de l’objet : Security  Type d’objet : File  Nom de l’objet : D:\dfs\appdata\magasin2\Application Data\Microsoft\Windows\Themes\CachedFiles\CachedImage_1440_900_POS4.jpg  ID du handle : 0x0

Filter 

%{TIMESTAMP_ISO8601:eventlog_timestamp}%{SYSLOGHOST:eventlog_host}%{DATA:eventlog_status}%{DATA:eventlog_id}%{DATA:eventlog_description}[.]

1 - %{TIMESTAMP_ISO8601:eventlog_timestamp} %{SYSLOGHOST:eventlog_host} %{DATA:eventlog_status} %{DATA:eventlog_id} %{GREEDYDATA:eventlog_description}[.] %{DATA:dummy_payload1}[:] %{DATA:dummy_payload2}[:] %{DATA:dummy_payload2}[:] %{DATA:evenlog_useraccount}[Domaine du compte :] %{DATA:dummy_payload3}[:] %{DATA:evenlog_domainaccount}[ID d’ouverture de session :  0x4D10413B4  Objet :  Serveur de l’objet : Security  Type d’objet : File  Nom de l’objet : ] 

2 - %{TIMESTAMP_ISO8601:eventlog_timestamp} %{SYSLOGHOST:eventlog_host} %{DATA:eventlog_status} %{DATA:eventlog_id} %{GREEDYDATA:eventlog_description}[.] %{DATA:dummy_payload1}[:] %{DATA:dummy_payload2}[:] %{DATA:dummy_payload2}[:] %{DATA:evenlog_useraccount}[Domaine du compte :] %{DATA:dummy_payload3}[:] %{DATA:evenlog_domainaccount}[  ID d’ouverture de session :  0x4D10413B4  Objet :  Serveur de l’objet : Security  Type d’objet : File  Nom de l’objet :] %{DATA:dummy_payload4} %{DATA:dummy_payload5}[:]%{DATA:dummy_payload6}[:]%{DATA:dummy_payload7}[:]%{DATA:dummy_payload8}[:]%{DATA:dummy_payload9}[:]%{DATA:evenlog_file}[  ID d’ouverture de session :  0x4D10413B4  Objet :  Serveur de l’objet : Security  Type d’objet : File  Nom de l’objet :] 


------------------------------------------------------------------------  

filter {
	if [type] == "eventlog" {
		grok {
			match => { "message" => "%{TIMESTAMP_ISO8601:eventlog_timestamp} %{SYSLOGHOST:eventlog_host} %{DATA:eventlog_status} %{DATA:eventlog_id} %{DATA:eventlog_description}[.]" }
			if [eventlog_id] == "4659" {
          		grok {
              		match => { "message" => "%{SYSLOGTIMESTAMP:syslog_timestamp} %{SYSLOGHOST:syslog_hostname} %{DATA:syslog_program}: %{DATA:json_payload}" }
         		}
            	mutate {
               		add_tag => [ "klima-nxlog-192.168.1.3-tag" ]
         		}
         	} 		
		} 
	}        
}


------------------------------------------------------------------------ 

grok {
   match => { "message" => "%{TIMESTAMP_ISO8601:eventlog_timestamp} %{SYSLOGHOST:eventlog_host} %{DATA:eventlog_status} %{DATA:eventlog_id} %{DATA:eventlog_decription}. %{GREEDYDATA:eventlog_payload}" }
}

if..... 

grok {
   match => { "eventlog_payload" => "%{SYSLOGTIMESTAMP:eventlog_timestamp} %{SYSLOGHOST:eventlog_host} %{DATA:syslog_program}: %{DATA:json_payload}" }
}

------------------------------------------------------------------------

2016-06-30 18:28:02 SRVKLIMAD.KLIMA.local AUDIT_SUCCESS 4659 Un handle vers un objet a été demandé dans un but de suppression.  Sujet :  ID de sécurité :  S-1-5-21-234956876-1872495229-1672620402-4140  Nom du compte :  Magasin2  Domaine du compte :  KLIMA  ID d’ouverture de session :  0x4D10413B4  Objet :  Serveur de l’objet : Security  Type d’objet : File  Nom de l’objet : D:\dfs\appdata\magasin2\Application Data\Microsoft\Windows\Themes\CachedFiles\CachedImage_1440_900_POS4.jpg  ID du handle : 0x0

------------------------------------------------------------------------

eventlog_timestamp -> 2016-06-30 16:26:32 
eventlog_host -> SRVKLIMAD.KLIMA.local 
eventlog_status -> AUDIT_SUCCESS 
eventlog_id -> 4656 
eventlog_decription -> Un handle vers un objet a été demandé. 
eventlog_payload -> Sujet :  
ID de sécurité :  S-1-5-21-234956876-1872495229-1672620402-4123  
Nom du compte :  franck  
Domaine du compte :  KLIMA  
ID d’ouverture de session   0x4B448B59E  
Objet :  
Serveur de l’objet :  
Security  Type d’objet :  
File  Nom de l’objet :  D:\\dfs\\commun\\CLIENTS DIRECTION\\CLIENTS\\TUBEST\\CATALOGUE DIFFUSION ET REPRISE DE L'AIR (VERSION 2013)\\BAREME CATALOGUE DIFFUSION & REPRISE DE L'AIR 2016.pdf 
ID du handle :  0x2ccc

------------------------------------------------------------------------

2016-06-30 16:26:32 
SRVKLIMAD.KLIMA.local 
AUDIT_SUCCESS 
4656 
Un handle vers un objet a été demandé.  
Sujet :  
ID de sécurité :  S-1-5-21-234956876-1872495229-1672620402-4123  
Nom du compte :  franck  
Domaine du compte :  KLIMA  
ID d’ouverture de session   0x4B448B59E  
Objet :  
Serveur de l’objet :  
Security  Type d’objet :  
File  Nom de l’objet :  D:\\dfs\\commun\\KLIMA 89\\Barêmes clients\\TUBEST\\CATALOGUE DIFFUSION ET REPRISE DE L'AIR (VERSION 2013)  
ID du handle :  0x4404  


eventlog_timestamp -> 2016-06-30 16:26:32 
eventlog_host -> SRVKLIMAD.KLIMA.local 
eventlog_status -> AUDIT_SUCCESS 
eventlog_id -> 4656 
eventlog_decription -> Un handle vers un objet a été demandé. 
Sujet :  
ID de sécurité :  S-1-5-21-234956876-1872495229-1672620402-4123  
Nom du compte :  franck  
Domaine du compte :  KLIMA  
ID d’ouverture de session   0x4B448B59E  
Objet :  
Serveur de l’objet :  
Security  Type d’objet :  
File  Nom de l’objet :  D:\\dfs\\commun\\CLIENTS DIRECTION\\CLIENTS\\TUBEST\\CATALOGUE DIFFUSION ET REPRISE DE L'AIR (VERSION 2013)\\BAREME CATALOGUE DIFFUSION & REPRISE DE L'AIR 2016.pdf 
ID du handle :  0x2ccc  


eventlog_timestamp -> 2016-06-30 17:25:59 
eventlog_host -> SRVKLIMAD.KLIMA.local 
eventlog_status -> AUDIT_FAILURE 
eventlog_id -> 4656 
eventlog_description -> Un handle vers un objet a été demandé.  
Sujet :  
ID de sécurité :  S-1-5-21-234956876-1872495229-1672620402-3229  
Nom du compte :  marie  
Domaine du compte :  KLIMA  
ID d’ouverture de session   0x4BB9E3A6E  
Objet :  Serveur de l’objet :  
Security  Type d’objet :  
File  Nom de l’objet :  D:\dfs\commun\MARIE\BUDGET\budget klima 2015  1.xlsx 
ID du handle :  0x0  

------------------------------------------------------------------------

2016-06-30 18:28:02 SRVKLIMAD.KLIMA.local AUDIT_SUCCESS 4659 Un handle vers un objet a été demandé dans un but de suppression.  Sujet :  ID de sécurité :  S-1-5-21-234956876-1872495229-1672620402-4140  Nom du compte :  Magasin2  Domaine du compte :  KLIMA  ID d’ouverture de session :  0x4D10413B4  Objet :  Serveur de l’objet : Security  Type d’objet : File  Nom de l’objet : D:\dfs\appdata\magasin2\Application Data\Microsoft\Windows\Themes\CachedFiles\CachedImage_1440_900_POS4.jpg  ID du handle : 0x0

------------------------------------------------------------------------

2016-06-30 16:49:45 SRVKLIMAD.KLIMA.local AUDIT_FAILURE 4625 Échec d’ouverture de session d’un compte.  Sujet :  ID de sécurité :  S-1-0-0  Nom du compte :  -  Domaine du compte :  -  ID d’ouverture de session :  0x0  Type d’ouverture de session :   3  Compte pour lequel l’ouverture de session a échoué :  ID de sécurité :  S-1-0-0  Nom du compte :  administrateur  Domaine du compte :    Informations sur l’échec :  Raison de l’échec :  Une erreur s’est produite lors de l’ouverture de session.  État :   0xC0000225  Sous-état :  0x0  Informations sur le processus :  ID du processus de l’appelant : 0x0  Nom du processus de l’appelant : -  Informations sur le réseau :  Nom de la station de travail : \\192.168.1.15  Adresse du réseau source : 192.168.1.15  Port source :  45453  Informations détaillées sur l’authentification :  Processus d’ouverture de session :    Package d’authentification : NTLM  Services en transit : -  Nom du package (NTLM uniquement) : -  Longueur de clé :  0  Cet événement est généré lorsqu’une demande d’ouverture de session échoue. Il est généré sur l’ordinateur sur lequel l’accès a été tenté.  Le champ Objet indique le compte sur le système local qui a demandé l’ouverture de session. Il s’agit le plus souvent d’un service, comme le service Serveur, ou un processus local tel que Winlogon.exe ou Services.exe.  Le champ Type d’ouverture de session indique le type d’ouverture de session qui a été demandé. Les types les plus courants sont 2 (interactif) et 3 (réseau).  Les champs relatifs aux informations sur le processus indiquent quel est le compte et le processus sur le système qui ont demandé l’ouverture de session.  Les champs relatifs aux informations sur le réseau indiquent la provenance de la demande d’ouverture de session distante. Le nom de la station de travail n’étant pas toujours disponible, peut rester vide dans certains cas.  Les champs relatifs aux informations d’authentification fournissent des détails sur cette demande d’ouverture de session spécifique.  - Les services en transit indiquent les services intermédiaires qui ont participé à cette demande d’ouverture de session.  - Le nom du package indique quel a été le sous-protocole qui a été utilisé parmi les protocoles NTLM.  - La longueur de la clé indique la longueur de la clé de session générée. Elle a la valeur 0 si aucune clé de session n’a été demandée.


------------------------------------------------------------------------

2016-06-30 16:26:32 SRVKLIMAD.KLIMA.local AUDIT_SUCCESS 4656 Un handle vers un objet a été demandé.  Sujet :  ID de sécurité :  S-1-5-21-234956876-1872495229-1672620402-4123  Nom du compte :  franck  Domaine du compte :  KLIMA  ID d’ouverture de session   0x4B448B59E  Objet :  Serveur de l’objet :  Security  Type d’objet :  File  Nom de l’objet :  D:\\dfs\\commun\\KLIMA 89\\Barêmes clients\\TUBEST\\CATALOGUE DIFFUSION ET REPRISE DE L'AIR (VERSION 2013)  ID du handle :  0x4404  


2016-06-30 16:26:32 SRVKLIMAD.KLIMA.local AUDIT_SUCCESS 4656 Un handle vers un objet a été demandé.  Sujet :  ID de sécurité :  S-1-5-21-234956876-1872495229-1672620402-4123  Nom du compte :  franck  Domaine du compte :  KLIMA  ID d’ouverture de session   0x4B448B59E  Objet :  Serveur de l’objet :  Security  Type d’objet :  File  Nom de l’objet :  D:\\dfs\\commun\\CLIENTS DIRECTION\\CLIENTS\\TUBEST\\CATALOGUE DIFFUSION ET REPRISE DE L'AIR (VERSION 2013)\\BAREME CATALOGUE DIFFUSION & REPRISE DE L'AIR 2016.pdf  ID du handle :  0x2ccc  


2016-06-30 17:25:59 SRVKLIMAD.KLIMA.local AUDIT_FAILURE 4656 Un handle vers un objet a été demandé.  Sujet :  ID de sécurité :  S-1-5-21-234956876-1872495229-1672620402-3229  Nom du compte :  marie  Domaine du compte :  KLIMA  ID d’ouverture de session   0x4BB9E3A6E  Objet :  Serveur de l’objet :  Security  Type d’objet :  File  Nom de l’objet :  D:\dfs\commun\MARIE\BUDGET\budget klima 2015  1.xlsx  ID du handle :  0x0  

------------------------------------------------------------------------

Attributs de ressource : -  Informations sur le processus :  ID du processus :  0x4  Nom du processus :    Informations sur la demande d’accès :  ID de la transaction   {00000000-0000-0000-0000-000000000000}  Accès :  DELETE     READ_CONTROL     WRITE_DAC     SYNCHRONIZE     Lecture données (ou liste de répertoire)     Écriture données (ou ajout fichier)     ReadEA     WriteEA     ReadAttributes     WriteAttributes       Raisons de l’accès :  -  Masque d’accès   0x17019B  Privilèges utilisés pour les vérifications d’accès : -  Nombre de SID restreints : 0

Attributs de ressource : -  Informations sur le processus :  ID du processus :  0x4  Nom du processus :    Informations sur la demande d’accès :  ID de la transaction   {00000000-0000-0000-0000-000000000000}  Accès :  READ_CONTROL     SYNCHRONIZE     Lecture données (ou liste de répertoire)     ReadEA     ReadAttributes       Raisons de l’accès :  READ_CONTROL: Accordé par D:(A;ID;FA;;;BU)     SYNCHRONIZE: Accordé par D:(A;ID;FA;;;BU)     Lecture données (ou liste de répertoire): Accordé par D:(A;ID;FA;;;BU)     ReadEA: Accordé par D:(A;ID;FA;;;BU)     ReadAttributes: Accordé par D:(A;ID;FA;;;BU)       Masque d’accès   0x120089  Privilèges utilisés pour les vérifications d’accès : -  Nombre de SID restreints : 0


Attributs de ressource : -  Informations sur le processus :  ID du processus :  0x4  Nom du processus :    Informations sur la demande d’accès :  ID de la transaction   {00000000-0000-0000-0000-000000000000}  Accès :  DELETE     READ_CONTROL     SYNCHRONIZE     ACCESS_SYS_SEC     Lecture données (ou liste de répertoire)     Écriture données (ou ajout fichier)     ReadEA     ReadAttributes       Raisons de l’accès :  DELETE: Accordé par ACE sur le dossier parent D:(A;OICIID;FA;;;BU)     READ_CONTROL: Accordé par la propriété     SYNCHRONIZE: Inconnu ou non contrôlé     ACCESS_SYS_SEC: Non accordé en raison d’un élément manquant SeSecurityPrivilege     Lecture données (ou liste de répertoire): Inconnu ou non contrôlé     Écriture données (ou ajout fichier): Inconnu ou non contrôlé     ReadEA: Inconnu ou non contrôlé     ReadAttributes: Accordé par ACE sur le dossier parent D:(A;OICIID;FA;;;BU)       Masque d’accès   0x113008B  Privilèges utilisés pour les vérifications d’accès : -  Nombre de SID restreints : 0



























